<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>25.8.25 レスポンシブ対応修正</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
      margin: 0;
      padding: 20px;
      background-color: #f9f9f9;
      color: #333;
      line-height: 1.6;
    }
    h1 {
      text-align: center;
      margin-bottom: 30px;
    }
    h2 {
      margin-top: 40px;
      border-bottom: 2px solid #ccc;
      padding-bottom: 5px;
    }
    .section {
      margin-bottom: 30px;
    }
    pre {
      background-color: #282c34;
      color: #f8f8f2;
      padding: 10px;
      border-radius: 4px;
      overflow-x: auto;
      position: relative;
    }
    .copy-btn {
      position: absolute;
      top: 5px;
      right: 5px;
      padding: 3px 8px;
      font-size: 12px;
      background-color: #007bff;
      color: white;
      border: none;
      border-radius: 3px;
      cursor: pointer;
    }
    .prompt, .answer {
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 15px;
    }
    .prompt {
      background-color: #e9f5ff;
      border: 1px solid #b3daff;
    }
    .answer {
      background-color: #f4f4f4;
      border: 1px solid #ddd;
    }
  </style>
</head>
<body>

<h1>25.8.25 レスポンシブ対応修正</h1>

<div class="section">
  <div class="prompt">
    <h2>私からのプロンプト</h2>
    <p>デプロイ成功おめでとうございます！ついに24時間いつでも使えるようになりましたね🎉  
    ご指摘の通り、今のデザインはPCのような広い画面を前提にしているため、iPhoneやiPadなどの幅が狭いデバイスではレイアウトが崩れてしまいます。  
    これは「レスポンシブデザイン」という考え方を用いて解決できます。CSSを少し修正して、スマホやタブレットの画面サイズにも自動で最適化されるようにしましょう。</p>
  </div>

  <div class="answer">
    <h2>AIからの回答（マニュアル化）</h2>
    <h3>修正ステップ</h3>
    <p>修正は2つのファイルにまたがります。</p>

    <h4>ステップ1：index.htmlに「魔法の一行」を追加する</h4>
    <p><code>&lt;head&gt;</code>タグの中に以下を追加してください。</p>
    <button class="copy-btn" onclick="copyCode(this)">コピー</button>
    <pre>&lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</pre>

    <h4>templates/index.html 全体例</h4>
    <button class="copy-btn" onclick="copyCode(this)">コピー</button>
    <pre>&lt;!DOCTYPE html&gt;
&lt;html lang="ja"&gt;
&lt;head&gt;
  &lt;meta charset="UTF-8"&gt;
  &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
  &lt;title&gt;ChatGPT風チャット&lt;/title&gt;
  &lt;link rel="stylesheet" href="/static/style.css"&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;div class="sidebar"&gt;
    &lt;h3&gt;ルーム&lt;/h3&gt;
    &lt;button id="new-chat-btn"&gt;新規チャット&lt;/button&gt;
    &lt;ul id="rooms"&gt;&lt;/ul&gt;
  &lt;/div&gt;
  &lt;div class="main-chat"&gt;
    &lt;div id="chat"&gt;&lt;/div&gt;
    &lt;div class="input-area"&gt;
      &lt;input id="prompt" placeholder="メッセージを入力..." /&gt;
      &lt;button id="send-btn"&gt;送信&lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
  &lt;script src="/static/script.js"&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>

    <h4>ステップ2：style.cssにスマホ用の設定を追加する</h4>
    <p>以下の内容で <code>static/style.css</code> を置き換えてください。</p>
    <button class="copy-btn" onclick="copyCode(this)">コピー</button>
    <pre>/* ===== 全体のレイアウト ===== */
body {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
  margin: 0;
  display: flex;
  height: 100vh;
  overflow: hidden;
}

/* ===== サイドバー（ルーム一覧） ===== */
.sidebar {
  width: 240px;
  background-color: #f0f0f0;
  padding: 15px;
  border-right: 1px solid #ddd;
  display: flex;
  flex-direction: column;
  box-sizing: border-box;
  transition: width 0.3s ease;
}

.sidebar h3 {
  margin-top: 0;
}

#new-chat-btn {
  width: 100%;
  padding: 8px;
  margin-bottom: 15px;
  background-color: #007bff;
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  transition: background-color 0.2s;
}
#new-chat-btn:hover { background-color: #0056b3; }

#rooms { list-style: none; padding: 0; margin: 0; overflow-y: auto; }
#rooms li a {
  display: block; padding: 8px; text-decoration: none; color: #333;
  border-radius: 4px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
}
#rooms li a:hover { background-color: #e0e0e0; }

/* ===== メインのチャットウィンドウ ===== */
.main-chat {
  flex-grow: 1; display: flex; flex-direction: column; height: 100vh;
}
#chat {
  flex-grow: 1; padding: 10px; overflow-y: auto; display: flex; flex-direction: column; gap: 10px;
}
.input-area {
  padding: 10px; border-top: 1px solid #ddd; display: flex; gap: 10px;
}
#prompt { flex-grow: 1; padding: 8px; border: 1px solid #ccc; border-radius: 4px; font-size: 16px; }
#send-btn {
  padding: 8px 15px; border: none; background-color: #28a745; color: white; border-radius: 4px; cursor: pointer; transition: background-color 0.2s;
}
#send-btn:hover { background-color: #218838; }
#send-btn:disabled { background-color: #aaa; cursor: not-allowed; }

/* ===== チャットメッセージのスタイル ===== */
.message { padding: 10px 15px; border-radius: 18px; max-width: 85%; word-wrap: break-word; white-space: pre-wrap; }
.user { background-color: #007bff; color: white; align-self: flex-end; }
.assistant { background-color: #e9e9eb; color: #000; align-self: flex-start; }

/* ===== スマホ・タブレット用の設定 ===== */
@media (max-width: 768px) {
  .sidebar { width: 60px; padding: 10px; }
  .sidebar h3, #rooms li a { font-size: 0; }
  #new-chat-btn { font-size: 0; position: relative; }
  #new-chat-btn::before {
    content: '+'; font-size: 24px; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
  }
  #rooms li a::before {
    content: attr(data-initial); font-size: 16px; display: flex; justify-content: center; align-items: center;
  }
}</pre>

    <h4>ステップ3：script.jsを修正</h4>
    <p>ルーム名の頭文字を表示するために <code>loadRooms</code> 関数を修正してください。</p>
    <button class="copy-btn" onclick="copyCode(this)">コピー</button>
    <pre>// static/script.js の中の loadRooms 関数
async function loadRooms() {
  const res = await fetch("/rooms");
  const rooms = await res.json();
  roomsList.innerHTML = "";
  rooms.reverse().forEach(r => {
    const li = document.createElement("li");
    const a = document.createElement("a");
    a.href = "#";
    a.innerText = r.title;
    a.setAttribute('data-initial', r.title.charAt(0));
    a.onclick = (event) => {
      event.preventDefault();
      selectRoom(r.id);
    };
    li.appendChild(a);
    roomsList.appendChild(li);
  });
}</pre>

    <h3>次に行っていただくこと</h3>
    <ul>
      <li><code>templates/index.html</code> に <code>&lt;meta&gt;</code> を追加</li>
      <li><code>static/style.css</code> を置き換え</li>
      <li><code>static/script.js</code> を修正</li>
      <li>変更をGitHubにプッシュ → Renderが自動デプロイ</li>
    </ul>
  </div>
</div>

<script>
function copyCode(button) {
  const codeBlock = button.nextElementSibling;
  navigator.clipboard.writeText(codeBlock.innerText).then(() => {
    button.innerText = "コピー済み";
    setTimeout(() => button.innerText = "コピー", 2000);
  });
}
</script>

</body>
</html>
